<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fate/Grand Order Servants Table</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/select/1.7.0/css/select.dataTables.min.css">

  <style>
    /* Layout tweaks to follow your requirements */
    /* Put pagination at top center */
    .dt-top-center {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 0.75rem;
    }

    /* Put length select and info at bottom left (entries + info stacked) */
    .dt-bottom-left {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 0.25rem;
    }

    /* Hide default search input (we don't include it in the DOM config but add extra safety) */
    .dataTables_filter { display: none !important; }

    /* make column search inputs smaller */
    tfoot input { width: 100%; box-sizing: border-box; }

    /* spacing when shown in tabs */
    .tab-pane { padding-top: 1rem; }
  </style>
</head>
<body>
<div class="container py-4">
  <h1 class="mb-3">FGO Servants — DataTables AJAX</h1>

  <!-- Tabs -->
  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="table1-tab" data-bs-toggle="tab" data-bs-target="#table1" type="button" role="tab">Table A</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="table2-tab" data-bs-toggle="tab" data-bs-target="#table2" type="button" role="tab">Table B</button>
    </li>
  </ul>
  <div class="tab-content" id="myTabContent">

    <!-- Each tab contains a copy of the table with its own id -->
    <div class="tab-pane fade show active" id="table1" role="tabpanel" aria-labelledby="table1-tab">
      <div class="dt-top-center" id="top-controls-1"></div>
      <div class="mb-2">
        <button id="deleteBtn1" class="btn btn-danger btn-sm">Delete selected</button>
        <div class="btn-group ms-2" role="group" aria-label="colvis">
          <!-- Column visibility will be injected via Buttons extension -->
        </div>
      </div>

      <table id="example1" class="display stripe" style="width:100%">
        <thead>
        <tr>
          <th>ID</th>
          <th>First name</th>
          <th>Last name</th>
          <th>Age</th>
          <th>Nationality</th>
          <th>Position</th>
          <th>Salary</th>
        </tr>
        </thead>
        <tfoot>
        <tr>
          <th><input placeholder="Search ID" /></th>
          <th><input placeholder="Search First" /></th>
          <th><input placeholder="Search Last" /></th>
          <th><input placeholder="Search Age" /></th>
          <th><input placeholder="Search Nationality" /></th>
          <th><input placeholder="Search Position" /></th>
          <th><input placeholder="Search Salary" /></th>
        </tr>
        </tfoot>
      </table>

      <div class="row mt-2">
        <div class="col-6">
          <div id="bottom-left-1" class="dt-bottom-left"></div>
        </div>
        <div class="col-6 text-end">
          <!-- reserved for anything else on right -->
        </div>
      </div>
    </div>

    <div class="tab-pane fade" id="table2" role="tabpanel" aria-labelledby="table2-tab">
      <div class="dt-top-center" id="top-controls-2"></div>
      <div class="mb-2">
        <button id="deleteBtn2" class="btn btn-danger btn-sm">Delete selected</button>
        <div class="btn-group ms-2" role="group" aria-label="colvis"></div>
      </div>

      <table id="example2" class="display stripe" style="width:100%">
        <thead>
        <tr>
          <th>ID</th>
          <th>First name</th>
          <th>Last name</th>
          <th>Age</th>
          <th>Nationality</th>
          <th>Position</th>
          <th>Salary</th>
        </tr>
        </thead>
        <tfoot>
        <tr>
          <th><input placeholder="Search ID" /></th>
          <th><input placeholder="Search First" /></th>
          <th><input placeholder="Search Last" /></th>
          <th><input placeholder="Search Age" /></th>
          <th><input placeholder="Search Nationality" /></th>
          <th><input placeholder="Search Position" /></th>
          <th><input placeholder="Search Salary" /></th>
        </tr>
        </tfoot>
      </table>

      <div class="row mt-2">
        <div class="col-6">
          <div id="bottom-left-2" class="dt-bottom-left"></div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- jQuery + Bootstrap + DataTables JS -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js"></script>
<script src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script>

<script>
  // Common DataTables config used for both tables
  const dtConfig = (topControlsSelector, bottomLeftSelector, deleteBtnId) => ({
    // AJAX datasource (relative path). Create `data/datatables-data.json` in the same repo.
    ajax: 'data/datatables-data.json',
    columns: [
      { data: 0, title: "ID" },
      { data: 1, title: "Name" },
      { data: 2, title: "Class" },
      { data: 3, title: "Rarity" },
      { data: 4, title: "Attribute" },
      { data: 5, title: "Region" },
      { data: 6, title: "Release Year" }
    ],

    // no global search field (we excluded 'f' from dom)
    dom: "<'dt-top'<'dt-top-center'p>>t<'dt-bottom'<'dt-bottom-left'l i>>",

    // enable selection
    select: {
      style: 'single'
    },

    // Buttons: column visibility
    buttons: [ 'colvis' ],

    // page length options
    lengthMenu: [ [5, 10, 25, 50], [5, 10, 25, 50] ],
    pageLength: 5,

    // drawCallback for moving elements into places we want
    drawCallback: function(settings) {
      const api = this.api();
      // move pagination to our top-controls container
      const pag = $(this.table().container()).find('.dataTables_paginate');
      $(topControlsSelector).empty().append(pag);

      // move length and info to bottom-left
      const length = $(this.table().container()).find('.dataTables_length');
      const info = $(this.table().container()).find('.dataTables_info');
      $(bottomLeftSelector).empty().append(length).append(info);
    }
  });

  // Initialize both tables
  const table1 = $('#example1').DataTable(dtConfig('#top-controls-1', '#bottom-left-1', 'deleteBtn1'));
  const table2 = $('#example2').DataTable(dtConfig('#top-controls-2', '#bottom-left-2', 'deleteBtn2'));

  // Add Buttons (ColVis) to both tables (they require initialization)
  new $.fn.dataTable.Buttons(table1, { buttons: ['colvis'] });
  table1.buttons().container().appendTo('#table1 .btn-group');

  new $.fn.dataTable.Buttons(table2, { buttons: ['colvis'] });
  table2.buttons().container().appendTo('#table2 .btn-group');

  // Column search: apply the search on each column footer input
  $('#example1 tfoot input').on('keyup change clear', function() {
    const colIndex = $(this).parent().index();
    table1.column(colIndex).search(this.value).draw();
  });

  $('#example2 tfoot input').on('keyup change clear', function() {
    const colIndex = $(this).parent().index();
    table2.column(colIndex).search(this.value).draw();
  });

  // Delete selected row (client-side remove only)
  $('#deleteBtn1').on('click', function() {
    const row = table1.row({ selected: true });
    if(!row.node()) { alert('Select a row first'); return; }
    if(confirm('Delete selected row from Table A?')) {
      row.remove().draw(false);
    }
  });

  $('#deleteBtn2').on('click', function() {
    const row = table2.row({ selected: true });
    if(!row.node()) { alert('Select a row first'); return; }
    if(confirm('Delete selected row from Table B?')) {
      row.remove().draw(false);
    }
  });

  // Optional: when switching tabs, redraw tables to ensure proper layout
  $('button[data-bs-toggle="tab"]').on('shown.bs.tab', function (e) {
    $.fn.dataTable.tables({visible: true, api: true}).columns.adjust();
  });
</script>

<!--
  === IMPORTANT: data/datatables-data.json ===
  Create a file in your repository at `data/datatables-data.json` (relative to this html file).
  Example content (7 columns per row). Save in `data/datatables-data.json`:

  {
    "data": [
      [1, "Artoria Pendragon", "Saber", 5, "Earth", "Britain", 2015],
      [2, "Gilgamesh", "Archer", 5, "Sky", "Mesopotamia", 2015],
      [3, "Jeanne d'Arc", "Ruler", 5, "Human", "France", 2015],
      [4, "Mash Kyrielight", "Shielder", 4, "Earth", "Chaldea", 2015],
      [5, "Karna", "Lancer", 5, "Sky", "India", 2017],
      [6, "Cu Chulainn", "Lancer", 3, "Earth", "Ireland", 2015],
      [7, "Merlin", "Caster", 5, "Sky", "Britain", 2017],
      [8, "Ishtar", "Archer", 5, "Sky", "Mesopotamia", 2017],
      [9, "Hokusai", "Foreigner", 5, "Human", "Japan", 2019],
      [10, "Okita Souji", "Saber", 5, "Human", "Japan", 2015],
      [11, "Scáthach", "Lancer", 5, "Human", "Ireland", 2016],
      [12, "Tamamo-no-Mae", "Caster", 5, "Earth", "Japan", 2015],
      [13, "Emiya", "Archer", 4, "Human", "Japan", 2015],
      [14, "Altria Pendragon (Lancer)", "Lancer", 5, "Earth", "Britain", 2016],
      [15, "Arjuna", "Archer", 5, "Sky", "India", 2016],
      [16, "Mordred", "Saber", 5, "Earth", "Britain", 2016],
      [17, "Ereshkigal", "Lancer", 5, "Sky", "Mesopotamia", 2018],
      [18, "Ozymandias", "Rider", 5, "Human", "Egypt", 2016],
      [19, "Francis Drake", "Rider", 5, "Human", "Britain", 2015],
      [20, "Jack the Ripper", "Assassin", 5, "Human", "England", 2015],
      [21, "King Hassan", "Assassin", 5, "Human", "Middle East", 2017],
      [22, "Abigail Williams", "Foreigner", 5, "Human", "USA", 2018],
      [23, "BB", "MoonCancer", 4, "Star", "SE.RA.PH", 2018],
      [24, "Sessyoin Kiara", "Alter Ego", 5, "Beast", "SE.RA.PH", 2018],
      [25, "Meltryllis", "Alter Ego", 5, "Star", "SE.RA.PH", 2018]
    ],
      [2, "Gilgamesh", "Archer", 5, "Sky", "Mesopotamia", 2015],
      [3, "Jeanne d'Arc", "Ruler", 5, "Human", "France", 2015],
      [4, "Mash Kyrielight", "Shielder", 4, "Earth", "Chaldea", 2015],
      [5, "Karna", "Lancer", 5, "Sky", "India", 2017],
      [6, "Cu Chulainn", "Lancer", 3, "Earth", "Ireland", 2015],
      [7, "Merlin", "Caster", 5, "Sky", "Britain", 2017],
      [8, "Ishtar", "Archer", 5, "Sky", "Mesopotamia", 2017],
      [9, "Hokusai", "Foreigner", 5, "Human", "Japan", 2019],
      [10, "Okita Souji", "Saber", 5, "Human", "Japan", 2015]
    ]
  }

  --- Notes & Deployment ---
  1) To use on GitHub Pages, put `datatables.html` in the root of your repo (or under `docs/`)
     and the JSON file at `data/datatables-data.json` (create a folder 'data').

  2) Push with git:
     git add datatables.html data/datatables-data.json
     git commit -m "Add DataTables AJAX example"
     git push origin main

  3) Enable GitHub Pages for the branch (main) and root folder in repo settings.
     The final URL will look like: https://<your-username>.github.io/<repo-name>/datatables.html
     e.g. https://klleww.github.io/cv/datatables.html

  4) If you test locally and hit CORS problems while developing on Windows, you can launch
     Chrome with the flags (as you mentioned):
     --disable-web-security --disable-gpu --user-data-dir=~/chromeTemp
     (Be careful: this disables web security; only use for local testing.)

  5) If you'd prefer the AJAX file hosted elsewhere, update the `ajax:` URL in the script.

-->

</body>
</html>
